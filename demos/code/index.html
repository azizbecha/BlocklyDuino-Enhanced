<!-- 
    Blockly Duino Enhanced Modded Version By Aziz Becha.
    GitHub: github.com/AzizVirus
    Feel Free to Use/Fork/Contribute.
 -->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="google" value="notranslate">
        <title>BlocklyDuino Enhanced</title>
        <link rel="stylesheet" href="../css/font-awesome-4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="../css/bootstrap.css">
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="common.css">

        <script src="/storage.js"></script>
        <script src="../../blockly_compressed.js"></script>
        <script src="../../blocks_compressed.js"></script>
        <script src="../../javascript_compressed.js"></script>

        <script src="../../blocks/inout.js"></script>
        <script src="../../blocks/serial.js"></script>
        <script src="../../blocks/softserial.js"></script>
        <script src="../../blocks/servo.js"></script>
        <script src="../../blocks/seriallcd.js"></script>
        <script src="../../blocks/seriallcdi2c.js"></script>
        <script src="../../blocks/divers.js"></script>
        <script src="../../blocks/logic.js"></script>
        <script src="../../blocks/loops.js"></script>
        <script src="../../blocks/math.js"></script>
        <script src="../../blocks/text.js"></script>  
        <script src="../../blocks/variables.js"></script>   
        <script src="../../blocks/procedures.js"></script>
        <script src="../../blocks/string.js"></script>  
        <script src="../../blocks/conversion.js"></script> 
        <script src="../../blocks/advanced.js"></script> 

        <script src="../../core/variables.js"></script> 
        <script src="../../core/procedures.js"></script> 
        <script src="../../core/string.js"></script>   
        <script src="../../core/flyout.js"></script> 
        <script src="../../core/field_string.js"></script> 
        <script src="../../core/block.js"></script> 
        <script src="../../core/blockly.js"></script> 
        <script src="../../core/workspace.js"></script> 

        <script src="../../generators/arduino.js"></script>
        <script src="../../generators/arduino/inout.js"></script>
        <script src="../../generators/arduino/serial.js"></script>
        <script src="../../generators/arduino/softserial.js"></script>
        <script src="../../generators/arduino/servo.js"></script>
        <script src="../../generators/arduino/seriallcd.js"></script>
        <script src="../../generators/arduino/seriallcdi2c.js"></script>
        <script src="../../generators/arduino/divers.js"></script>
        <script src="../../generators/arduino/math.js"></script>
        <script src="../../generators/arduino/logic.js"></script>
        <script src="../../generators/arduino/loops.js"></script>
        <script src="../../generators/arduino/text.js"></script>  
        <script src="../../generators/arduino/variables.js"></script>
        <script src="../../generators/arduino/procedures.js"></script>
        <script src="../../generators/arduino/string.js"></script>
        <script src="../../generators/arduino/conversion.js"></script>
        <script src="../../generators/arduino/advanced.js"></script>

        <script type="text/javascript" src="Blob.js"></script>
        <script type="text/javascript" src="blockly_helper.js"></script>
        <script type="text/javascript" src="FileSaver.min.js"></script>
        <script type="text/javascript" src="spin.js"></script>

        <script src="dist/clipboard.min.js"></script>

        <script src="code.js"></script>
        <script src="common.js"></script>
        
        <script>
            window.onbeforeunload = function(event) {
                return confirm("Are you sure you want to reload the page ? If yes, the blocks will be discarded.");
            }
        </script>

    </head>
    <body>
        <table width="100%" height="100%">
            <tr>
                <td>
                    
                    <h3 style="margin-top:8px" class="blockly_title">&nbsp;BlocklyDuino Enhanced </h3>
                    <h6 class="blockly_title">&nbsp; Modded Version by Aziz Becha</h6>
                    <p>&nbsp; <a href="https://github.com/AzizVirus" target="_blank" rel="noopener noreferrer">github.com/AzizVirus</a></p>
                    <div id="dialogShadow" class="dialogAnimate"></div>
                    <div id="dialogBorder"></div>
                    <div id="dialog"></div> 
                </td>
                <td class="farSide">
                    <select style="width:25%;float:right;margin-bottom:-1px" 
                            class="form-control" 
                            id="languageMenu">
                    </select>
                </td>
            </tr>
            <tr>
                <td colspan=2>
                    <table width="100%">
                        <tr id="tabRow" height="1em">
                            <td id="tab_blocks" class="tabon">...</td>
                            <td class="tabmin">&nbsp;</td>
                            <td id="tab_arduino" class="taboff"><span style="font-style: normal;" class="fa fa-code">&nbsp;Arduino</span></td>
                            <td class="tabmin">&nbsp;</td>
                            <td id="tab_xml" class="taboff"> <span style="font-style: normal;" class="fa fa-code">&nbsp;XML</span></td>
                            <td class="tabmax">
                                <a target="_blank" href="http://easycoding.tn">easycoding.tn</a>
                                
                                 <a target="_blank" href="http://easycoding.tn/index.php/buy-components/">Buy components</a>
                               
                                 <a target="_blank" href="http://easycoding.tn/index.php/nodemcu/">Tutorial</a>

                                 
                                <button id="linkButton" class="notext" title="...">
                                    <img src='../../media/1x1.gif' class="link icon21">
                                </button>

                                <!-- The save .ino button -->
                                <button id="runButton" class="notext primary" title="..." onclick="saveCode()">
                                    <img src='../../media/1x1.gif' class="run icon21">
                                </button>

                                <!-- The copy arduino code button -->
                                <button onclick="alert('Arduino code copied to clipboard successfully !')" id="copyButton" class="btn1" data-clipboard-target="#fool">
                                    <img src='../../media/iconecopy.png' class="run icon21">
                                </button>
                                
                                <!-- The save XML button -->
                                <button onclick="save()" id="savexmlButton"><img src='../../media/SAVEXML.png' class="run icon21"></button>
                                
                                <!-- The load XML button -->
                                <button id="fakeload"><img src='../../media/loadxml.jpg' class="run icon21"></button>
                                <input type="file" id="load" style="display: none;"/>

                                <!-- The delete blocks button -->
                                <button id="trashButton" class="notext" title="...">
                                    <img src='../../media/1x1.gif' class="trash icon21">
                                </button>

                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td height="99%" colspan=2 id="content_area">
                </td>
               
            </tr>
        </table>
        <div id="content_blocks" class="content"></div>
        <pre id="content_arduino" class="content"></pre>
        <textarea id="content_xml" class="content" wrap="off"></textarea>

    <xml id="toolbox" style="display: none">
        <category id="catInOut" colour="10">
            <category id="catDigital" colour="10">
                <block type="inout_highlow"></block>
                <block type="inout_buildin_led"></block>
                <block type="inout_digital_write"></block>
                <block type="inout_digital_read"></block>
            </category>
            <category id="catAnalog" colour="10">
                <block type="inout_analog_read"></block>
                <block type="inout_analog_write" x="63" y="38">
                    <field name="PIN">3</field>
                    <value name="Value">
                        <block  type="math_number">
                            <field name="NUM">0</field>
                        </block>
                    </value>
                </block>
            </category>
        </category>
        <category id="catSerial" colour="30">
            <block type="serial_printfor" x="13" y="38">
                <field name="TYPE">DEC</field>
                <value name="CONTENT">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
            </block>
            <block type="serial_read"></block>
            <block type="serial_available"></block>
            <block type="serial_print" x="13" y="13">
                <value name="CONTENT">
                    <block type="text">
                        <field name="TEXT"></field>
                    </block>
                </value>
            </block>
            <block type="serial_printL" x="13" y="38">
                <value name="CONTENT">
                    <block type="text">
                        <field name="TEXT"></field>
                    </block>
                </value>
            </block>
            <block type="serial_write" x="38" y="38">
                <value name="CONTENT">
                    <block type="text">
                        <field name="TEXT"></field>
                    </block>
                </value>
            </block>
            <block type="serial_write_out" x="63" y="63">
                <value name="valeur">
                    <block type="text">
                        <field name="TEXT"></field>
                    </block>
                </value>
            </block>
            <block type="serial_flush"></block>
        </category>
        <category id="catSoftSerial" colour="50">
            <block type="soft_init"></block>
            <block type="soft_read"></block>
            <block type="soft_print"></block>
            <block type="soft_write"></block>
            <block type="soft_available"></block>  
        </category>
        <category id="catServo" colour="80">        
            <block type="servo_move" x="63" y="38">
                <field name="PIN">0</field>
                <value name="DEGREE">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
                <value name="DELAY_TIME">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
            </block>
            <block type="servo_read_degrees"></block>
            <block type="servo_attached"></block>
            <block type="servo_detach"></block>
        </category>
        <category id="catDivers" colour="150">
            <block type="grove_temporature_sensor"></block>
            <block type="grove_ultrasonic_ranger"></block>
            <block type="grove_motor_shield"></block>
            <block type="base_delayms">
                <value name="DELAY_TIME">
                    <block type="math_number" id="20">
                        <field name="NUM">1000</field>
                    </block>
                </value>
            </block>
            <block type="millis"></block>
            <block type="var_random"></block>
            <block type="various_constrain"></block>
        </category>
        <category id="catString" colour="210" custom="STRING"></category>
        <sep></sep>
        <category id="catDisplay" colour="150">
            <category id="catLCD" colour="125">
                <block type="lcd_setup" x="63" y="38">
                    <field name="RSPIN">12</field>
                    <field name="EPIN">11</field>
                    <field name="D4PIN">5</field>
                    <field name="D5PIN">4</field>
                    <field name="D6PIN">3</field>
                    <field name="D7PIN">2</field>
                    <value name="COLUMNS">
                        <block type="math_number">
                            <field name="NUM">16</field>
                        </block>
                    </value>
                    <value name="ROWS">
                        <block type="math_number">
                            <field name="NUM">2</field>
                        </block>
                    </value>
                </block>
                <block type="lcd_print" x="38" y="88">
                    <value name="texttoprint">
                        <block type="text">
                            <field name="TEXT">Hello World!</field>
                        </block>
                    </value>
                </block>
                <block type="lcd_clear"></block>
                <block type="lcd_home"></block>
                <block type="lcd_setcursor" x="38" y="113">
                    <value name="column">
                        <block type="math_number">
                            <field name="NUM">1</field>
                        </block>
                    </value>
                    <value name="row">
                        <block type="math_number">
                            <field name="NUM">1</field>
                        </block>
                    </value>
                </block>
                <block type="lcd_display"></block> 
                <block type="lcd_nodisplay"></block>
            </category>
            <category id="catSerialLCD" colour="120">
                <block type="grove_serial_lcd_print"></block>
                <block type="grove_serial_lcd_power"></block>
                <block type="grove_serial_lcd_effect"></block>
            </category>
            <category id="catSerialLCD_I2C" colour="140">
                <block type="lcdi2c_setup" x="38" y="138">
                    <field name="NAME">0x3F</field>
                    <value name="COLUMNS">
                        <block type="math_number">
                            <field name="NUM">16</field>
                        </block>
                    </value>
                    <value name="ROWS">
                        <block type="math_number">
                            <field name="NUM">2</field>
                        </block>
                    </value>
                </block>
                <block type="lcdi2c_print" x="38" y="88">
                    <value name="texttoprint">
                        <block type="text">
                            <field name="TEXT">Hello World!</field>
                        </block>
                    </value>
                </block>
                <block type="lcdi2c_clear"></block>
                <block type="lcdi2c_home"></block>
                <block type="lcdi2c_setcursor" x="38" y="113">
                    <value name="column">
                        <block type="math_number">
                            <field name="NUM">0</field>
                        </block>
                    </value>
                    <value name="row">
                        <block type="math_number">
                            <field name="NUM">0</field>
                        </block>
                    </value>
                </block>
                <block type="lcdi2c_display"></block> 
                <block type="lcdi2c_nodisplay"></block>
                <block type="lcdi2c_scrollDisplayLeft"></block> 
                <block type="lcdi2c_scrollDisplayRight"></block> 
            </category>
            <category id="catOLED" colour="150">
                <block type="oled_setup">
                    <field name="NAME">0x3C</field>
                </block>
                <block type="oled_print" x="38" y="88">
                    <value name="texttoprint">
                        <block type="text">
                            <field name="TEXT">Hello World!</field>
                        </block>
                    </value>
                </block>
                <block type="oled_clear"></block>
                <block type="oled_setcursor" x="38" y="113">
                    <value name="column">
                        <block type="math_number">
                            <field name="NUM">1</field>
                        </block>
                    </value>
                    <value name="row">
                        <block type="math_number">
                            <field name="NUM">1</field>
                        </block>
                    </value>
                </block>
            </category>    
        </category>
        <sep></sep>


        <category id="catConversion" colour="165"> 
            <block type="conversion_tochar"></block>
            <block type="conversion_tobyte"></block>
            <block type="conversion_toint"></block>
            <block type="conversion_tofloat"></block>
        </category>
        <category id="catAdvanced" colour="185"> 
            <block type="advanced_tone">
                <value name="NUM">
                    <block type="math_number">
                        <field name="NUM">440</field>
                    </block>
                </value>
            </block>
            <block type="advanced_tonedure">
                <value name="NUM">
                    <block type="math_number">
                        <field name="NUM">440</field>
                    </block>
                </value>
                <value name="DUR">
                    <block type="math_number">
                        <field name="NUM">1000</field>
                    </block>
                </value>
            </block>
            <block type="advanced_notone"></block>
            <block type="advanced_pulsein"></block> 
            <block type="arduino_setup"></block>

        </category>
        <sep></sep>
        <category id="catLogic" colour="210">

            <block type="controls_if"></block>
            <block type="logic_compare"></block>
            <block type="logic_operation"></block>
            <block type="logic_null"></block>
            <block type="logic_boolean"></block>
            <block type="logic_negate"></block>
        </category>

        <category id="catLoops" colour="190">
            <block type="while_do"></block>
            <block type="do_while"></block>
            <block type="cont_break"></block>
            <block type="cont_continue"></block>  
            <block type="controls_for">
                <value name="FROM">
                    <block type="math_number">
                        <field name="NUM">1</field>
                    </block>
                </value>
                <value name="TO">
                    <block type="math_number">
                        <field name="NUM">10</field>
                    </block>
                </value>
                <value name="BY">
                    <block type="math_number">
                        <field name="NUM">1</field>
                    </block>
                </value>
            </block>   
            <block type="controls_repeat_x" x="113" y="38">
                <value name="TIMES">
                    <block type="math_number">
                        <field name="NUM">10</field>
                    </block>
                </value>
            </block>
        </category>

        <category id="catMath" colour="230">
            <block type="base_map">
                <value name="value">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
                <value name="fromLow">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
                <value name="fromHigh">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
                <value name="toLow">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
                <value name="toHigh">
                    <block type="math_number">
                        <field name="NUM">0</field>
                    </block>
                </value>
            </block>
            <block type="math_number"></block>
            <block type="math_arithmetic"></block>
            <block type="math_trig"></block>
        </category>
        <category id="catText" colour="160">
            <block type="text"></block>
            <block type="text_char"></block>
        </category>
        <sep></sep>

        <sep></sep>
        <category id="catVariables" colour="330" custom="VARIABLE"></category>
        <category id="catFunctions" colour="290" custom="PROCEDURE"></category>
    </xml>

    <div id="badBlockDiv" class="dialogHiddenContent">
        <table>
            <tbody>
                <tr>
                    <td id="badBlockMsg" colspan=2></td>
                </tr>
                <tr>
                    <td colspan=2></td>
                </tr>
                <tr>
                    <td>
                        <button id='badBlockDoneButton' onclick="BlocklyApps.hideDialog();">
                            OK
                        </button>
                    </td>
                    <td>
                    </td>
                </tr>
            </tbody>
        </table>

    </div>



    <script type="text/javascript">  var loadInput = document.getElementById('load');
        loadInput.addEventListener('change', load, false);
        document.getElementById('fakeload').onclick = function () {
            loadInput.click();
        };

        //addChangeListener(onchange);

        function onchange() {

            document.getElementById('capacity').innerHTML = Code.workspace.Numberallblock();
        }
        
               //COPY 
        var clipboard = new Clipboard('.btn1');

        clipboard.on('ready', function (e) {

        });
        clipboard.on('copy', function (e) {

        });

        clipboard.on('success', function (e) {
            //alert("good");
            //console.info('Action:', e.action);
            //console.info('Text:', e.text);
            //console.info('Trigger:', e.trigger);

            e.clearSelection();
        });

        clipboard.on('error', function (e) {
            alert("BAD");
            //console.error('Action:', e.action);
            //console.error('Trigger:', e.trigger);
        });
    </script>

        <script>
        function changeme() {

        }
        function onchange(event) {

            //document.getElementById('fool').textContent = workspace.remainingCapacity();
            //document.getElementById('foo').innerHTML = Code.workspace.Numberallblock();
        }
        code.workspace.addChangeListener(onchange);
        onchange();
    </script>
    
    <p>
        <textarea id="fool" rows="4" cols="50"></textarea>
    </p>
</body>
</html>
